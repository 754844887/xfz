function Banner(){this.bannerULWidth=798,this.bannerGroup=$("#banner-group"),(this.self=this).index=1,this.rightArrow=$(".right-arrow"),this.leftArrow=$(".left-arrow"),this.bannerUL=$("#banner-ul"),this.pageControl=$(".page-control"),this.liList=this.bannerUL.children("li"),this.bannerCount=this.liList.length}function Loadmore(){this.page=2,this.category=0,this.loadBtn=$("#load-more-btn"),template.defaults.imports.timeSince=function(n){var e=new Date(n),t=e.getTime(),i=((new Date).getTime()-t)/1e3;if(i<60)return"刚刚";if(60<=i&&i<3600)return parseInt(i/60)+"分钟前";if(3600<=i&&i<86400)return hours=parseInt(i/3600),hours+"小时前";if(86400<=i&&i<2592e3)return(o=parseInt(i/86400))+"天前";var r=e.getFullYear(),a=e.getMonth(),o=e.getDay();return r+"/"+a+"/"+o+" "+e.getHours()+":"+e.getMinutes()}}Banner.prototype.initBannerUL=function(){var n=this,e=n.liList.eq(0).clone(),t=n.liList.eq(n.bannerCount-1).clone();n.bannerUL.append(e),n.bannerUL.prepend(t),n.bannerUL.css({width:n.bannerULWidth*(n.bannerCount+2),left:-n.bannerULWidth})},Banner.prototype.initPageControl=function(){var n=this;for(i=0;i<n.bannerCount;i++){var e=$("<li></li>");n.pageControl.append(e),0===i&&e.addClass("active")}n.pageControl.css({width:10*n.bannerCount+16+16*(n.bannerCount-1)})},Banner.prototype.toggleArrow=function(n){var e=this;n?(e.rightArrow.show(),e.leftArrow.show()):(e.rightArrow.hide(),e.leftArrow.hide())},Banner.prototype.listenBannerHover=function(){var n=this;this.bannerGroup.hover(function(){n.toggleArrow(!0),clearInterval(n.timer)},function(){n.toggleArrow(!1),n.loop()})},Banner.prototype.listenArrowClick=function(){var n=this;n.leftArrow.click(function(){0===n.index?(n.bannerUL.css({left:-n.bannerULWidth*n.bannerCount}),n.index=n.bannerCount-1):n.index--,console.log(n.index),n.animate()}),n.rightArrow.click(function(){n.index===n.bannerCount+1?(n.bannerUL.css({left:-n.bannerULWidth}),n.index=2):n.index++,n.animate()})},Banner.prototype.listenPageControlClick=function(){var t=this;t.pageControl.children("li").each(function(n,e){$(e).click(function(){t.index=n+1,t.animate()})})},Banner.prototype.animate=function(){var n=this;n.bannerUL.stop().animate({left:-798*n.index},500),n.index>=n.bannerCount+1?n.pageControl.children("li").eq(0).addClass("active").siblings().removeClass("active"):n.pageControl.children("li").eq(n.index-1).addClass("active").siblings().removeClass("active")},Banner.prototype.loop=function(){var n=this;this.timer=setInterval(function(){n.index>=n.bannerCount+1?(n.bannerUL.css({left:-n.bannerULWidth}),n.index=2):n.index++,n.animate()},2e3)},Banner.prototype.run=function(){this.initPageControl(),this.initBannerUL(),this.loop(),this.listenBannerHover(),this.listenArrowClick(),this.listenPageControlClick()},Loadmore.prototype.listenMoreEvent=function(){var i=this;i.loadBtn.click(function(){myajax.get({url:"/news/news_list/",data:{p:i.page,category_id:i.category},success:function(n){if(200===n.code){var e=n.data;if(0<e.length){var t=template("news-item",{newses:e});$("#list-more").append(t),i.page+=1}else i.loadBtn.hide()}}})})},Loadmore.prototype.listenCategoryChangeEvent=function(){var r=this;$(".list-tab").children().click(function(){r.page=1;var n=$(this);r.category=n.attr("data-category"),r.loadBtn.show(),n.addClass("active").siblings().removeClass("active"),myajax.get({url:"/news/news_list/",data:{p:r.page,category_id:r.category},success:function(n){if(200===n.code){var e=n.data,t=$("#list-more");if(0<e.length){var i=template("news-item",{newses:e});t.empty().append(i),r.page+=1}else t.empty()}}})})},Loadmore.prototype.run=function(){this.listenMoreEvent(),this.listenCategoryChangeEvent()},$(function(){(new Banner).run(),(new Loadmore).run()});